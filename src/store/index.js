import Vue from 'vue';
import Vuex from 'vuex';

Vue.use(Vuex);

export default new Vuex.Store({
  state: {
    hocComponent: 'startPage',
    currentQuestion: 1,
    score: 0,
    status: true,
    finish: {
      beginner: {
        id: 1,
        condition: { min: 0, max: 4 },
        title: 'Новичок в&nbsp;строительном языке',
        text: `Вероятно, вы пока далеки от&nbsp;стройплощадки, а метизы вам понятнее блошек.
        Чаще бывайте на объектах и&nbsp;практикуйтесь с носителями языка.`,
      },
      skilled: {
        id: 2,
        condition: { min: 5, max: 6 },
        title: 'Знаток строительного языка',
        text: `Часть слов вы знаете, а остальные наверняка можете понять интуитивно. 
        Вы не потеряетесь на стройплощадке и сможете отличить заподлицо от чернухи.`,
      },
      expert: {
        id: 3,
        condition: { min: 7, max: 8 },
        title: 'Я — эксперт строительного языка',
        text: `Часть слов вы знаете, а остальные наверняка можете понять интуитивно. 
        Вы не потеряетесь на стройплощадке и сможете отличить заподлицо от чернухи.`,
      },
      highLevel: {
        id: 4,
        condition: { min: 9, max: 10 },
        title: 'Носитель строительного языка',
        text: `С вами можно и в котлован, и на кран — вы всегда понимаете, что происходит, 
        и можете объяснить это другим. Можете даже открыть свой курс строительного языка.`,
      },
    },
    questions: [
      {
        id: 1,
        action: 'К вам подходит работник и&nbsp;говорит:',
        cloud: '— Тут такое дело. Отсыпь блошек, а? Мои кончились.',
        question: 'Что сделаете?',
        rightAnswerId: 3,
        rightAnswerText: 'Блошки — это саморезы и шурупы небольшого размера',
        answers: [
          { id: 1, text: 'Найду ближайшую бездомную собаку и потрясу её.' },
          { id: 2, text: 'Рассмеюсь. Блошек, хах! Вот удумал, а.' },
          { id: 3, text: 'Подам ему пакет с мелкими шурупами и саморезами.' },
          { id: 4, text: 'Отойду от работника подальше.' },
        ],
      },
      {
        id: 2,
        action: 'К вам подходит матерый строитель и спрашивает:',
        cloud: '— Шурика не видел? Вопрос жизни и смерти!',
        question: 'Что он хочет узнать?',
        rightAnswerId: 3,
        rightAnswerText: 'Шурик — это шуруповерт.',
        answers: [
          { id: 1, text: 'Видел ли я «Операцию „Ы“ и другие приключения Шурика».' },
          { id: 2, text: 'Куда делся стропальщик Саня.' },
          { id: 3, text: 'Срочно нужен шуруповерт.' },
          { id: 4, text: 'Ему нужен микрофон Shure.' },
        ],
      },
      {
        id: 3,
        action: 'В разгар рабочего дня к вам подбегает бригадир:',
        cloud: '— Калошу потерял. Ты её не видел?',
        question: 'Чего-чего?',
        rightAnswerId: 3,
        rightAnswerText: 'Калоша — это бункер для подачи бетона.',
        answers: [
          { id: 1, text: 'Бригадир потерял свою обувь. Нужно помочь ее найти.' },
          { id: 2, text: 'А, понятно! Кто-то увез бункер для подачи бетона. Осталось выяснить куда.' },
          { id: 3, text: 'Калошей строители называют тарелку для еды. Кто-то останется без обеда.' },
          { id: 4, text: 'Скорее всего это фамилия какой-нибудь крановщицы.' },
        ],
      },
      {
        id: 4,
        action: 'К вам подходит рабочий и недоуменно произносит:',
        cloud: '— Ну и денек — вторая пачка кончилась. Есть еще?',
        question: 'Что он хочет узнать?',
        rightAnswerId: 3,
        rightAnswerText: 'Пачка — это стопка листового металла.',
        answers: [
          { id: 1, text: 'Хочет стрельнуть у меня сигаретку, а то и всю пачку.' },
          { id: 2, text: 'Элементарно. Пачка — это листы металла, сложенные друга на друга.' },
          { id: 3, text: 'Пачка — это бетономешалка. Ну что же, придется отправлять на завод еще одну.' },
          { id: 4, text: 'Это может быть что угодно. Пачка чая, например.' },
        ],
      },
      {
        id: 5,
        action: `У котлована вы встретили сварщика и разговорились. В одной из историй он широко 
        развел руками и сказал:`,
        cloud: '— Я по молодости вот такого зайчика словил.',
        question: 'О чем он?',
        rightAnswerId: 3,
        rightAnswerText: 'Словить зайчика — это случайно посмотреть на сварку.',
        answers: [
          { id: 1, text: 'Видимо мимо пробегал заяц, которого он поймал.' },
          {
            id: 2, text: `Словить зайчика — это случайно посмотреть на сварку. После этого в глазах 
            мелькают искры — зайчики.`,
          },
          {
            id: 3, text: `Зайчик — это премия. Сварщик тогда хорошо потрудился 
          и узнал размер доплаты.`,
          },
          { id: 4, text: 'Зайчиком называют электрод немецкой фирмы ZAICH.' },
        ],
      },
      {
        id: 6,
        action: 'Прораб машет вам рукой и просит подойти. Вы видите грунтовую площадку. Прораб:',
        cloud: '— Ну, сами видите. Шлеп-нога понадобится. А то и несколько.',
        question: 'Кто это? Что это?',
        rightAnswerId: 3,
        rightAnswerText: 'Шлёп-нога — это аппарат для вибротрамбовки поверхностей.',
        answers: [
          { id: 1, text: 'Прозвище бульдозериста, который должен приехать и все разровнять.' },
          { id: 2, text: 'Элементарно. Это специальная широкая лопата для грунта.' },
          { id: 3, text: 'Меня не подловишь! Нет такого термина в строительстве.' },
          { id: 4, text: 'Судя по всему, это вибротрамбовщик.' },
        ],
      },
      {
        id: 7,
        action: `Около вагончика строителей вы замечаете только что отгруженную партию металлоизделий. 
        Стоящий рядом сварщик спрашивает:`,
        cloud: '— Нравится тыщевка?',
        question: 'Что-что?',
        rightAnswerId: 3,
        rightAnswerText: 'Тыщевка — это труба диаметром 1 000 миллиметров.',
        answers: [
          { id: 1, text: 'Так называют большую партию стройматериалов.' },
          { id: 2, text: 'Тыщевка — это вагончик строителей. На обеде туда может поместиться тысяча человек.' },
          { id: 3, text: 'Это общая скорость работы. Тыщевка может быть быстрой или медленной.' },
          { id: 4, text: 'Сварщик увидел трубу диаметром 1 000 миллиметров. Это и есть тыщевка.' },
        ],
      },
      {
        id: 8,
        action: 'Работник задумчиво смотрит в вырытую траншею. Вы подходите к нему. Он произносит:',
        cloud: '— Скоро тут чернуха будет.',
        question: 'Что будет?',
        rightAnswerId: 3,
        rightAnswerText: 'Чернуха — это труба из черного металла.',
        answers: [
          { id: 1, text: 'Грязь, месиво, рев бульдозеров. В общем, какие-то сложные строительные работы.' },
          { id: 2, text: 'Работники так называют ягоду чернику. Видимо, решил засеять ей траншею.' },
          { id: 3, text: 'Это не траншея, а яма для ремонта техники. Скоро здесь будут чумазые механики.' },
          { id: 4, text: 'Хм, судя по всему, здесь будут проложены трубы из черного металла.' },
        ],
      },
      {
        id: 9,
        action: 'Работник с довольным видом смотрит на уложенную плитку и произносит:',
        cloud: '— Заподлицо получилось, хе-хе.',
        question: 'Что будет?',
        rightAnswerId: 3,
        rightAnswerText: 'Заподлицо — это укладка вровень с поверхностью.',
        answers: [
          { id: 1, text: 'Работник сделал какую-то подляну. Возможно, положил под плитку ключи от соседней бытовки.' },
          { id: 2, text: 'Это простое одобрение. Заподлицо значит «хорошо».' },
          {
            id: 3, text: `Работник представляет свое повышение в должности. 
            Был подлицо, а станет заподлицо.`,
          },
          { id: 4, text: 'Ничего особенного. Просто уложил плитку вровень с поверхностью.' },
        ],
      },
      {
        id: 10,
        action: 'Высоченный работник смотрит на слегка гнутый лист проката. Затем он зычно выдает:',
        cloud: '— Балду в студию!',
        question: 'Чего-о-о?',
        rightAnswerId: 3,
        rightAnswerText: 'Балда — это кувалда.',
        answers: [
          { id: 1, text: 'Балда — это провинившийся работник, который сейчас будет выпрямлять этот лист.' },
          { id: 2, text: 'Легкий вопрос. Балда — это специальный гидравлический распрямитель металла.' },
          { id: 3, text: 'Опять пытаетесь меня подловить. Нет такого слова в языке строителей.' },
          { id: 4, text: 'Ничего особенного. Просто уложил плитку вровень с поверхностью.' },
        ],
      },
    ],
  },
  mutations: {
    testStart(state) {
      state.hocComponent = 'test';
    },
    showIntermediateResult(state, id) {
      const question = state.questions[state.currentQuestion - 1];
      const { rightAnswerId } = question;
      const isCorrect = rightAnswerId === id;

      if (isCorrect) state.score += 1;
      state.status = isCorrect;

      state.hocComponent = 'result';
    },
    nextQuestion(state) {
      const isFinish = state.currentQuestion === state.questions.length;

      if (isFinish) {
        state.hocComponent = 'finish';
      } else {
        state.currentQuestion += 1;
        state.hocComponent = 'test';
      }
    },
    beginTestAgain(state) {
      state.score = 0;
      state.currentQuestion = 1;
      state.hocComponent = 'test';
    },
  },
  actions: {
  },
  modules: {
  },
  getters: {
    hocComponent: (s) => s.hocComponent,
    currentQuestion: (s) => s.questions[s.currentQuestion - 1],
    numberCurrentQuestion: (s) => s.currentQuestion,
    amountQuestions: (s) => s.questions.length,
    status: (s) => s.status,
    finish: (s) => {
      const { score, finish } = s;
      const finishKeys = Object.keys(finish);

      let result;
      for (let i = 0; i < finishKeys.length; i += 1) {
        const key = finishKeys[i];
        const { min, max } = finish[key].condition;
        if (score >= min && score <= max) {
          result = finish[key];
          break;
        }
      }
      return result;
    },
  },
});
